#!/usr/bin/env node

var nssocket = require('nssocket')
  , join = require('path').join
  , fs = require('fs')
  , net = require('net')

var CONFPATH = join(process.env.HOME, '.swiftz')
  , SOCKPATH = join(CONFPATH, 'swiftz.sock')

var socket = nssocket.createServer(function (socket) {

  socket.data('login', function (data) {
    console.log([].slice.call(arguments))
  })

}).listen(SOCKPATH, function () {
  console.log('listening %s', SOCKPATH)
})

process.on('exit', function () {
  if (socket) socket.close()
  console.log('exit')
})

process.on('SIGINT', function () {
  socket.close()
  socket = undefined
  console.log('exit by SIGINT')
})
